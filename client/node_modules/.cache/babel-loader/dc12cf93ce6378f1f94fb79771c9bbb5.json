{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect, useCallback } from 'react';\nimport twelvedata, { apikey } from '../api/twelvedataAPI';\n\nconst useActionsDetails = (optionSelected = 1, intervalo = 1, actionSelected) => {\n  _s();\n\n  const [timeInterval, setTimeInterval] = useState();\n  const [error, setError] = useState('');\n  const [values, setValues] = useState([]);\n  const [desde, setDesde] = useState('');\n  const [hasta, setHasta] = useState('');\n  const [chartOptions, setChartOptions] = useState();\n  const [isLoading, setIsLoading] = useState(false);\n  useEffect(() => {\n    return () => {\n      clearInterval(timeInterval);\n    };\n  }, [timeInterval]);\n\n  const graficar = async () => {\n    const time = setInterval(() => loadValues(), intervalo * 60000);\n    setTimeInterval(time);\n    clearInterval(time);\n  };\n\n  const loadValues = async () => {\n    setIsLoading(true);\n    clearInterval(timeInterval);\n    setError('');\n    let newValues = [];\n\n    if (optionSelected === 0) {\n      try {\n        console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\n        const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\n        newValues = res.data.values.map(({\n          datetime,\n          open\n        }) => {\n          const d = new Date(datetime);\n          const date = d.getHours() + ':' + (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();\n          return {\n            date,\n            value: +open\n          };\n        });\n        setValues(newValues.reverse().slice(newValues.length - 5, newValues.length));\n        graficar();\n      } catch (error) {\n        console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\n        console.log(error);\n      }\n    }\n\n    if (optionSelected === 1) {\n      if (desde.trim() === '' || hasta.trim() === '') {\n        setError('Por favor seleccione una fecha de inicio y de fin');\n        return false;\n      }\n\n      const date_desde = new Date(desde);\n      const date_hasta = new Date(hasta);\n\n      if (date_desde > date_hasta) {\n        setError('Por favor seleccione una fecha de inicio menor a la de fin');\n        return false;\n      }\n\n      try {\n        const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`);\n        newValues = res.data.values.map(({\n          datetime,\n          open\n        }) => {\n          const d = new Date(datetime);\n          const date = d.getHours() + ':' + (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();\n          return {\n            date,\n            value: +open\n          };\n        });\n        setValues(newValues.reverse().slice(newValues.length - 5, newValues.length));\n        graficar();\n      } catch (error) {\n        console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`);\n        console.log(error);\n      }\n    }\n\n    setIsLoading(false);\n  };\n\n  const changeOptions = useCallback(() => {\n    setChartOptions({\n      series: [{\n        data: values.map(({\n          value\n        }) => value),\n        name: 'Cotización',\n        enablePolling: true,\n        dataRefreshRate: intervalo\n      }],\n      title: {\n        text: actionSelected.symbol\n      },\n      xAxis: [{\n        tickintervalo: 1,\n        title: {\n          text: 'intervalo'\n        },\n        labels: {\n          enabled: true,\n          formatter: val => values[val.value].date\n        }\n      }],\n      yAxis: [{\n        title: {\n          text: 'Cotizacion'\n        }\n      }]\n    });\n  }, [intervalo, actionSelected.symbol, values]);\n  return {\n    values,\n    error,\n    setDesde,\n    setHasta,\n    changeOptions,\n    chartOptions,\n    loadValues,\n    isLoading\n  };\n};\n\n_s(useActionsDetails, \"mQlXGsGhKc3jUdX+UvOXz4p7p18=\");\n\nexport default useActionsDetails;","map":{"version":3,"sources":["C:/Users/xenei/Desktop/origin-test/client/src/hooks/useActionsDetails.tsx"],"names":["useState","useEffect","useCallback","twelvedata","apikey","useActionsDetails","optionSelected","intervalo","actionSelected","timeInterval","setTimeInterval","error","setError","values","setValues","desde","setDesde","hasta","setHasta","chartOptions","setChartOptions","isLoading","setIsLoading","clearInterval","graficar","time","setInterval","loadValues","newValues","console","log","symbol","res","get","data","map","datetime","open","d","Date","date","getHours","getMinutes","value","reverse","slice","length","trim","date_desde","date_hasta","changeOptions","series","name","enablePolling","dataRefreshRate","title","text","xAxis","tickintervalo","labels","enabled","formatter","val","yAxis"],"mappings":"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","sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport twelvedata, {apikey} from '../api/twelvedataAPI';\r\n\r\nconst useActionsDetails = (optionSelected: number = 1, intervalo: number = 1, actionSelected: any) => {\r\n\r\n    const [timeInterval, setTimeInterval] = useState<NodeJS.Timeout>()\r\n    const [error, setError] = useState('')\r\n    const [values, setValues] = useState<any>([])\r\n    const [desde, setDesde] = useState('')\r\n    const [hasta, setHasta] = useState('')\r\n    const [chartOptions, setChartOptions] = useState<any>();\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            clearInterval(timeInterval)\r\n        }\r\n    }, [timeInterval])\r\n\r\n    const graficar = async () => {\r\n        const time = setInterval(() => loadValues(),intervalo * 60000)\r\n        setTimeInterval(time)\r\n        clearInterval(time)\r\n    }\r\n\r\n    const loadValues = async () => {\r\n\r\n        setIsLoading(true)\r\n\r\n        clearInterval(timeInterval)\r\n        setError('')\r\n        let newValues = [];\r\n\r\n        if(optionSelected === 0){\r\n            try {\r\n                console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\r\n                const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`)\r\n                newValues = res.data.values.map(({datetime,open}: any) => {\r\n                    const d = new Date(datetime)\r\n                    const date = d.getHours()+':'+(d.getMinutes()<10?'0':'') + d.getMinutes();\r\n                    return {date, value: +open }\r\n                })\r\n\r\n                setValues(newValues.reverse().slice(newValues.length - 5,newValues.length))\r\n                graficar()\r\n            } catch (error) {\r\n                console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\r\n                console.log(error);\r\n            }\r\n        }\r\n\r\n        if(optionSelected === 1){\r\n\r\n            if(desde.trim() === '' || hasta.trim() === '') {\r\n                setError('Por favor seleccione una fecha de inicio y de fin')\r\n                return false;\r\n            }\r\n\r\n            const date_desde = new Date(desde);\r\n            const date_hasta = new Date(hasta);\r\n\r\n            if(date_desde > date_hasta){\r\n                setError('Por favor seleccione una fecha de inicio menor a la de fin')\r\n                return false;\r\n            }\r\n\r\n            try {\r\n                const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`)\r\n                newValues = res.data.values.map(({datetime,open}: any) => {\r\n                    const d = new Date(datetime)\r\n                    const date = d.getHours()+':'+(d.getMinutes()<10?'0':'') + d.getMinutes();\r\n                    return {date, value: +open }\r\n                })\r\n                setValues(newValues.reverse().slice(newValues.length - 5,newValues.length))\r\n                graficar()\r\n            } catch (error) {\r\n                console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`);\r\n                console.log(error);\r\n            }\r\n        }\r\n\r\n        setIsLoading(false)\r\n\r\n    }\r\n\r\n    const changeOptions = useCallback(() => {\r\n            setChartOptions({\r\n                series: [\r\n                    {\r\n                        data: values.map(({value}: any) => value),\r\n                        name:'Cotización',\r\n                        enablePolling: true,\r\n                        dataRefreshRate: intervalo\r\n                    },\r\n                ],\r\n                title: {\r\n                    text:actionSelected.symbol\r\n                },\r\n                xAxis: [{\r\n                    tickintervalo: 1,\r\n                    title: {\r\n                        text: 'intervalo',\r\n                    },\r\n                    labels: {\r\n                            enabled: true,\r\n                            formatter: (val: any) => values[val.value].date\r\n                        }\r\n                }],\r\n                yAxis: [{\r\n                    title: {\r\n                        text: 'Cotizacion'\r\n                    }\r\n                }],\r\n            })\r\n        },[intervalo, actionSelected.symbol, values])\r\n\r\n    return {\r\n        values,\r\n        error,\r\n        setDesde,\r\n        setHasta,\r\n        changeOptions,\r\n        chartOptions,\r\n        loadValues,\r\n        isLoading\r\n    }\r\n}\r\n\r\nexport default useActionsDetails\r\n"]},"metadata":{},"sourceType":"module"}