{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect, useCallback } from 'react';\nimport twelvedata, { apikey } from '../api/twelvedataAPI';\n\nconst useActionsDetails = (optionSelected = 1, intervalo = 1, actionSelected) => {\n  _s();\n\n  const [timeInterval, setTimeInterval] = useState();\n  const [error, setError] = useState('');\n  const [values, setValues] = useState([]);\n  const [desde, setDesde] = useState('');\n  const [hasta, setHasta] = useState('');\n  const [chartOptions, setChartOptions] = useState();\n  useEffect(() => {\n    return () => {\n      clearInterval(timeInterval);\n    };\n  }, []);\n\n  const graficar = async () => {\n    const time = setInterval(() => loadValues(), intervalo * 60000);\n    setTimeInterval(time);\n    clearInterval(time);\n  };\n\n  const loadValues = async () => {\n    clearInterval(timeInterval);\n    setError('');\n    let newValues = [];\n\n    if (optionSelected === 0) {\n      try {\n        console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\n        const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\n        newValues = res.data.values.map(({\n          datetime,\n          open\n        }) => {\n          const d = new Date(datetime);\n          const date = d.getHours() + ':' + (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();\n          return {\n            date,\n            value: +open\n          };\n        });\n        setValues(newValues.reverse().slice(newValues.length - 5, newValues.length));\n        graficar();\n      } catch (error) {\n        console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\n        console.log(error);\n      }\n    }\n\n    if (optionSelected === 1) {\n      if (desde.trim() === '' || hasta.trim() === '') {\n        setError('Por favor seleccione una fecha de inicio y de fin');\n        return false;\n      }\n\n      const date_desde = new Date(desde);\n      const date_hasta = new Date(hasta);\n\n      if (date_desde > date_hasta) {\n        setError('Por favor seleccione una fecha de inicio menor a la de fin');\n        return false;\n      }\n\n      try {\n        const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`);\n        newValues = res.data.values.map(({\n          datetime,\n          open\n        }) => {\n          const d = new Date(datetime);\n          const date = d.getHours() + ':' + (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();\n          return {\n            date,\n            value: +open\n          };\n        });\n        setValues(newValues.reverse().slice(newValues.length - 5, newValues.length));\n        graficar();\n      } catch (error) {\n        console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`);\n        console.log(error);\n      }\n    }\n  };\n\n  const changeOptions = useCallback(() => {\n    setChartOptions({\n      series: [{\n        data: values.map(({\n          value\n        }) => value),\n        name: 'CotizaciÃ³n',\n        enablePolling: true,\n        dataRefreshRate: intervalo\n      }],\n      title: {\n        text: actionSelected.symbol\n      },\n      xAxis: [{\n        tickintervalo: 1,\n        title: {\n          text: 'intervalo'\n        },\n        labels: {\n          enabled: true,\n          formatter: val => values[val.value].date\n        }\n      }],\n      yAxis: [{\n        title: {\n          text: 'Cotizacion'\n        }\n      }]\n    });\n  }, [intervalo, actionSelected.symbol, values]);\n  return {\n    values,\n    error,\n    setDesde,\n    setHasta,\n    changeOptions,\n    chartOptions,\n    loadValues\n  };\n};\n\n_s(useActionsDetails, \"LHXHRlNDecSxRZhTH2z3SbTvj5w=\");\n\nexport default useActionsDetails;","map":{"version":3,"sources":["C:/Users/xenei/Desktop/origin-test/client/src/hooks/useActionsDetails.tsx"],"names":["useState","useEffect","useCallback","twelvedata","apikey","useActionsDetails","optionSelected","intervalo","actionSelected","timeInterval","setTimeInterval","error","setError","values","setValues","desde","setDesde","hasta","setHasta","chartOptions","setChartOptions","clearInterval","graficar","time","setInterval","loadValues","newValues","console","log","symbol","res","get","data","map","datetime","open","d","Date","date","getHours","getMinutes","value","reverse","slice","length","trim","date_desde","date_hasta","changeOptions","series","name","enablePolling","dataRefreshRate","title","text","xAxis","tickintervalo","labels","enabled","formatter","val","yAxis"],"mappings":"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","sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport twelvedata, {apikey} from '../api/twelvedataAPI';\r\n\r\nconst useActionsDetails = (optionSelected: number = 1, intervalo: number = 1, actionSelected: any) => {\r\n\r\n    const [timeInterval, setTimeInterval] = useState<any>()\r\n    const [error, setError] = useState('')\r\n    const [values, setValues] = useState<any>([])\r\n    const [desde, setDesde] = useState('')\r\n    const [hasta, setHasta] = useState('')\r\n    const [chartOptions, setChartOptions] = useState<any>();\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            clearInterval(timeInterval)\r\n        }\r\n    }, [])\r\n\r\n    const graficar = async () => {\r\n        const time = setInterval(() => loadValues(),intervalo * 60000)\r\n        setTimeInterval(time)\r\n        clearInterval(time)\r\n    }\r\n\r\n    const loadValues = async () => {\r\n\r\n        clearInterval(timeInterval)\r\n        setError('')\r\n        let newValues = [];\r\n\r\n        if(optionSelected === 0){\r\n            try {\r\n                console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\r\n                const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`)\r\n                newValues = res.data.values.map(({datetime,open}: any) => {\r\n                    const d = new Date(datetime)\r\n                    const date = d.getHours()+':'+(d.getMinutes()<10?'0':'') + d.getMinutes();\r\n                    return {date, value: +open }\r\n                })\r\n\r\n                setValues(newValues.reverse().slice(newValues.length - 5,newValues.length))\r\n                graficar()\r\n            } catch (error) {\r\n                console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&apikey=${apikey}`);\r\n                console.log(error);\r\n            }\r\n        }\r\n\r\n        if(optionSelected === 1){\r\n\r\n            if(desde.trim() === '' || hasta.trim() === '') {\r\n                setError('Por favor seleccione una fecha de inicio y de fin')\r\n                return false;\r\n            }\r\n\r\n            const date_desde = new Date(desde);\r\n            const date_hasta = new Date(hasta);\r\n\r\n            if(date_desde > date_hasta){\r\n                setError('Por favor seleccione una fecha de inicio menor a la de fin')\r\n                return false;\r\n            }\r\n\r\n            try {\r\n                const res = await twelvedata.get(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`)\r\n                newValues = res.data.values.map(({datetime,open}: any) => {\r\n                    const d = new Date(datetime)\r\n                    const date = d.getHours()+':'+(d.getMinutes()<10?'0':'') + d.getMinutes();\r\n                    return {date, value: +open }\r\n                })\r\n                setValues(newValues.reverse().slice(newValues.length - 5,newValues.length))\r\n                graficar()\r\n            } catch (error) {\r\n                console.log(`https://api.twelvedata.com/time_series?symbol=${actionSelected.symbol}&interval=${intervalo}min&start_date=${desde}%2009:48:00&end_date=${hasta}%2019:48:00&apikey=${apikey}`);\r\n                console.log(error);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    const changeOptions = useCallback(() => {\r\n            setChartOptions({\r\n                series: [\r\n                    {\r\n                        data: values.map(({value}: any) => value),\r\n                        name:'CotizaciÃ³n',\r\n                        enablePolling: true,\r\n                        dataRefreshRate: intervalo\r\n                    },\r\n                ],\r\n                title: {\r\n                    text:actionSelected.symbol\r\n                },\r\n                xAxis: [{\r\n                    tickintervalo: 1,\r\n                    title: {\r\n                        text: 'intervalo',\r\n                    },\r\n                    labels: {\r\n                            enabled: true,\r\n                            formatter: (val: any) => values[val.value].date\r\n                        }\r\n                }],\r\n                yAxis: [{\r\n                    title: {\r\n                        text: 'Cotizacion'\r\n                    }\r\n                }],\r\n            })\r\n        },[intervalo, actionSelected.symbol, values])\r\n\r\n    return {\r\n        values,\r\n        error,\r\n        setDesde,\r\n        setHasta,\r\n        changeOptions,\r\n        chartOptions,\r\n        loadValues\r\n    }\r\n}\r\n\r\nexport default useActionsDetails\r\n"]},"metadata":{},"sourceType":"module"}